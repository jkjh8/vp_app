import{i as ye,k as Zt,l as vt,aH as xt,q as f,z as v,B as el,a2 as Ct,j as Ve,a3 as kt,aI as Ft,n as M,aD as ve,ao as re,ar as tl,Z as qt,_ as zt,v as pe,x as Ge,aJ as ll,ac as al,aa as ul,V as mt,aK as nl,Q as Ee,P as gt,C as ol,a8 as il,I as rl,a9 as fe,aL as sl,$ as cl,a1 as dl,a0 as fl,aM as Vt,aN as Je,aO as At,aP as Bt,ae as vl,al as ml,az as gl,aQ as hl,aR as ht,aS as Sl,aT as Oe,an as bl,aU as Ke,aV as pl,aW as yl,am as _l,X as wl,y as xl}from"./index-D06vnydI.js";import{b as Cl,h as St,n as bt}from"./format-CJebrXOQ.js";import{g as kl}from"./use-dialog-plugin-component-Dw_I3MMD.js";import{Q as Fl,c as ql,b as zl}from"./QMenu-CtJ5DN5R.js";const aa=ye({name:"QUploaderAddTrigger",setup(){const e=Zt(xt,vt);return e===vt&&console.error("QUploaderAddTrigger needs to be child of QUploader"),e}}),Vl=ye({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:r}){const n=f(()=>parseInt(e.lines,10)),o=f(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(n.value===1?" ellipsis":"")),h=f(()=>e.lines!==void 0&&n.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":n.value}:null);return()=>v("div",{style:h.value,class:o.value},el(r.default))}}),Al={...Ct,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},Ye=50,It=2*Ye,Ot=It*Math.PI,Bl=Math.round(Ot*1e3)/1e3,Il=ye({name:"QCircularProgress",props:{...Al,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:r}){const{proxy:{$q:n}}=Ve(),o=kt(e),h=f(()=>{const b=(n.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(n.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-b}deg)`:`rotate3d(0, 0, 1, ${b-90}deg)`}}),i=f(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),z=f(()=>It/(1-e.thickness/2)),p=f(()=>`${z.value/2} ${z.value/2} ${z.value} ${z.value}`),y=f(()=>Cl(e.value,e.min,e.max)),R=f(()=>e.max-e.min),g=f(()=>e.thickness/2*z.value),x=f(()=>{const b=(e.max-y.value)/R.value,l=e.rounded===!0&&y.value<e.max&&b<.25?g.value/2*(1-b/.25):0;return Ot*b+l});function C({thickness:b,offset:l,color:V,cls:S,rounded:k}){return v("circle",{class:"q-circular-progress__"+S+(V!==void 0?` text-${V}`:""),style:i.value,fill:"transparent",stroke:"currentColor","stroke-width":b,"stroke-dasharray":Bl,"stroke-dashoffset":l,"stroke-linecap":k,cx:z.value,cy:z.value,r:Ye})}return()=>{const b=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&b.push(v("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:Ye-g.value/2,cx:z.value,cy:z.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&b.push(C({cls:"track",thickness:g.value,offset:0,color:e.trackColor})),b.push(C({cls:"circle",thickness:g.value,offset:x.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const l=[v("svg",{class:"q-circular-progress__svg",style:h.value,viewBox:p.value,"aria-hidden":"true"},b)];return e.showValue===!0&&l.push(v("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},r.default!==void 0?r.default():[v("div",y.value)])),v("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:o.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:y.value},Ft(r.internal,l))}}});function qe(e,r,n,o){const h=[];return e.forEach(i=>{o(i)===!0?h.push(i):r.push({failedPropValidation:n,file:i})}),h}function Ue(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),re(e)}const Ol={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},Rl=["rejected"];function El({editable:e,dnd:r,getFileInput:n,addFilesToQueue:o}){const{props:h,emit:i,proxy:z}=Ve(),p=M(null),y=f(()=>h.accept!==void 0?h.accept.split(",").map(m=>(m=m.trim(),m==="*"?"*/":(m.endsWith("/*")&&(m=m.slice(0,m.length-1)),m.toUpperCase()))):null),R=f(()=>parseInt(h.maxFiles,10)),g=f(()=>parseInt(h.maxTotalSize,10));function x(m){if(e.value)if(m!==Object(m)&&(m={target:null}),m.target?.matches('input[type="file"]')===!0)m.clientX===0&&m.clientY===0&&ve(m);else{const U=n();U!==m.target&&U?.click(m)}}function C(m){e.value&&m&&o(null,m)}function b(m,U,T,Z){let _=Array.from(U||m.target.files);const E=[],X=()=>{E.length!==0&&i("rejected",E)};if(h.accept!==void 0&&y.value.indexOf("*/")===-1&&(_=qe(_,E,"accept",O=>y.value.some(D=>O.type.toUpperCase().startsWith(D)||O.name.toUpperCase().endsWith(D))),_.length===0))return X();if(h.maxFileSize!==void 0){const O=parseInt(h.maxFileSize,10);if(_=qe(_,E,"max-file-size",D=>D.size<=O),_.length===0)return X()}if(h.multiple!==!0&&_.length!==0&&(_=[_[0]]),_.forEach(O=>{O.__key=O.webkitRelativePath+O.lastModified+O.name+O.size}),Z===!0){const O=T.map(D=>D.__key);_=qe(_,E,"duplicate",D=>O.includes(D.__key)===!1)}if(_.length===0)return X();if(h.maxTotalSize!==void 0){let O=Z===!0?T.reduce((D,G)=>D+G.size,0):0;if(_=qe(_,E,"max-total-size",D=>(O+=D.size,O<=g.value)),_.length===0)return X()}if(typeof h.filter=="function"){const O=h.filter(_);_=qe(_,E,"filter",D=>O.includes(D))}if(h.maxFiles!==void 0){let O=Z===!0?T.length:0;if(_=qe(_,E,"max-files",()=>(O++,O<=R.value)),_.length===0)return X()}if(X(),_.length!==0)return _}function l(m){Ue(m),r.value!==!0&&(r.value=!0)}function V(m){re(m),(m.relatedTarget!==null||tl.is.safari!==!0?m.relatedTarget!==p.value:document.elementsFromPoint(m.clientX,m.clientY).includes(p.value)===!1)===!0&&(r.value=!1)}function S(m){Ue(m);const U=m.dataTransfer.files;U.length!==0&&o(null,U),r.value=!1}function k(m){if(r.value===!0)return v("div",{ref:p,class:`q-${m}__dnd absolute-full`,onDragenter:Ue,onDragover:Ue,onDragleave:V,onDrop:S})}return Object.assign(z,{pickFiles:x,addFiles:C}),{pickFiles:x,addFiles:C,onDragover:l,onDragleave:V,processFiles:b,getDndNode:k,maxFilesNumber:R,maxTotalSizeNumber:g}}function pt(e){return(e*100).toFixed(2)+"%"}const Ll={...qt,...Ol,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,thumbnailFit:{type:String,default:"cover"},autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Rt=[...Rl,"start","finish","added","removed"];function Ml(e,r){const n=Ve(),{props:o,slots:h,emit:i,proxy:z}=n,{$q:p}=z,y=zt(o,p);function R(u,F,$){if(u.__status=F,F==="idle"){u.__uploaded=0,u.__progress=0,u.__sizeLabel=St(u.size),u.__progressLabel="0.00%";return}if(F==="failed"){z.$forceUpdate();return}u.__uploaded=F==="uploaded"?u.size:$,u.__progress=F==="uploaded"?1:Math.min(.9999,u.__uploaded/u.size),u.__progressLabel=pt(u.__progress),z.$forceUpdate()}const g=f(()=>o.disable!==!0&&o.readonly!==!0),x=M(!1),C=M(null),b=M(null),l={files:M([]),queuedFiles:M([]),uploadedFiles:M([]),uploadedSize:M(0),updateFileStatus:R,isAlive:()=>nl(n)===!1},{pickFiles:V,addFiles:S,onDragover:k,onDragleave:m,processFiles:U,getDndNode:T,maxFilesNumber:Z,maxTotalSizeNumber:_}=El({editable:g,dnd:x,getFileInput:a,addFilesToQueue:s});Object.assign(l,e({props:o,slots:h,emit:i,helpers:l,exposeApi:u=>{Object.assign(l,u)}})),l.isBusy===void 0&&(l.isBusy=M(!1));const E=M(0),X=f(()=>E.value===0?0:l.uploadedSize.value/E.value),O=f(()=>pt(X.value)),D=f(()=>St(E.value)),G=f(()=>g.value===!0&&l.isUploading.value!==!0&&(o.multiple===!0||l.queuedFiles.value.length===0)&&(o.maxFiles===void 0||l.files.value.length<Z.value)&&(o.maxTotalSize===void 0||E.value<_.value)),w=f(()=>g.value===!0&&l.isBusy.value!==!0&&l.isUploading.value!==!0&&l.queuedFiles.value.length!==0);ol(xt,Q);const ee=f(()=>"q-uploader column no-wrap"+(y.value===!0?" q-uploader--dark q-dark":"")+(o.bordered===!0?" q-uploader--bordered":"")+(o.square===!0?" q-uploader--square no-border-radius":"")+(o.flat===!0?" q-uploader--flat no-shadow":"")+(o.disable===!0?" disabled q-uploader--disable":"")+(x.value===!0?" q-uploader--dnd":"")),ae=f(()=>"q-uploader__header"+(o.color!==void 0?` bg-${o.color}`:"")+(o.textColor!==void 0?` text-${o.textColor}`:""));pe(l.isUploading,(u,F)=>{F===!1&&u===!0?i("start"):F===!0&&u===!1&&i("finish")});function te(){o.disable===!1&&(l.abort(),l.uploadedSize.value=0,E.value=0,de(),l.files.value=[],l.queuedFiles.value=[],l.uploadedFiles.value=[])}function K(){o.disable===!1&&ce(["uploaded"],()=>{l.uploadedFiles.value=[]})}function se(){ce(["idle","failed"],({size:u})=>{E.value-=u,l.queuedFiles.value=[]})}function ce(u,F){if(o.disable===!0)return;const $={files:[],size:0},J=l.files.value.filter(j=>u.indexOf(j.__status)===-1?!0:($.size+=j.size,$.files.push(j),j.__img!==void 0&&window.URL.revokeObjectURL(j.__img.src),!1));$.files.length!==0&&(l.files.value=J,F($),i("removed",$.files))}function ne(u){o.disable||(u.__status==="uploaded"?l.uploadedFiles.value=l.uploadedFiles.value.filter(F=>F.__key!==u.__key):u.__status==="uploading"?u.__abort():E.value-=u.size,l.files.value=l.files.value.filter(F=>F.__key!==u.__key?!0:(F.__img!==void 0&&window.URL.revokeObjectURL(F.__img.src),!1)),l.queuedFiles.value=l.queuedFiles.value.filter(F=>F.__key!==u.__key),i("removed",[u]))}function de(){l.files.value.forEach(u=>{u.__img!==void 0&&window.URL.revokeObjectURL(u.__img.src)})}function a(){return b.value||C.value.getElementsByClassName("q-uploader__input")[0]}function s(u,F){const $=U(u,F,l.files.value,!0),J=a();J!=null&&(J.value=""),$!==void 0&&($.forEach(j=>{if(l.updateFileStatus(j,"idle"),E.value+=j.size,o.noThumbnails!==!0&&j.type.toUpperCase().startsWith("IMAGE")){const me=new Image;me.src=window.URL.createObjectURL(j),j.__img=me}}),l.files.value=l.files.value.concat($),l.queuedFiles.value=l.queuedFiles.value.concat($),i("added",$),o.autoUpload===!0&&l.upload())}function q(){w.value===!0&&l.upload()}function L(u,F,$){if(u===!0){const J={type:"a",key:F,icon:p.iconSet.uploader[F],flat:!0,dense:!0};let j;return F==="add"?(J.onClick=V,j=Q):J.onClick=$,v(gt,J,j)}}function Q(){return v("input",{ref:b,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:o.accept,multiple:o.multiple===!0?"multiple":void 0,capture:o.capture,onMousedown:ve,onClick:V,onChange:s})}function I(){return h.header!==void 0?h.header(H):[v("div",{class:"q-uploader__header-content column"},[v("div",{class:"flex flex-center no-wrap q-gutter-xs"},[L(l.queuedFiles.value.length!==0,"removeQueue",se),L(l.uploadedFiles.value.length!==0,"removeUploaded",K),l.isUploading.value===!0?v(mt,{class:"q-uploader__spinner"}):null,v("div",{class:"col column justify-center"},[o.label!==void 0?v("div",{class:"q-uploader__title"},[o.label]):null,v("div",{class:"q-uploader__subtitle"},[D.value+" / "+O.value])]),L(G.value,"add"),L(o.hideUploadBtn===!1&&w.value===!0,"upload",l.upload),L(l.isUploading.value,"clear",l.abort)])])]}function A(){return h.list!==void 0?h.list(H):l.files.value.map(u=>v("div",{key:u.__key,class:"q-uploader__file relative-position"+(o.noThumbnails!==!0&&u.__img!==void 0?" q-uploader__file--img":"")+(u.__status==="failed"?" q-uploader__file--failed":u.__status==="uploaded"?" q-uploader__file--uploaded":""),style:o.noThumbnails!==!0&&u.__img!==void 0?{backgroundImage:'url("'+u.__img.src+'")',backgroundSize:o.thumbnailFit}:null},[v("div",{class:"q-uploader__file-header row flex-center no-wrap"},[u.__status==="failed"?v(Ee,{class:"q-uploader__file-status",name:p.iconSet.type.negative,color:"negative"}):null,v("div",{class:"q-uploader__file-header-content col"},[v("div",{class:"q-uploader__title"},[u.name]),v("div",{class:"q-uploader__subtitle row items-center no-wrap"},[u.__sizeLabel+" / "+u.__progressLabel])]),u.__status==="uploading"?v(Il,{value:u.__progress,min:0,max:1,indeterminate:u.__progress===0}):v(gt,{round:!0,dense:!0,flat:!0,icon:p.iconSet.uploader[u.__status==="uploaded"?"done":"clear"],onClick:()=>{ne(u)}})])]))}Ge(()=>{l.isUploading.value===!0&&l.abort(),l.files.value.length!==0&&de()});const H={};for(const u in l)ll(l[u])===!0?al(H,u,()=>l[u].value):H[u]=l[u];return Object.assign(H,{upload:q,reset:te,removeUploadedFiles:K,removeQueuedFiles:se,removeFile:ne,pickFiles:V,addFiles:S}),ul(H,{canAddFiles:()=>G.value,canUpload:()=>w.value,uploadSizeLabel:()=>D.value,uploadProgressLabel:()=>O.value}),r({...l,upload:q,reset:te,removeUploadedFiles:K,removeQueuedFiles:se,removeFile:ne,pickFiles:V,addFiles:S,canAddFiles:G,canUpload:w,uploadSizeLabel:D,uploadProgressLabel:O}),()=>{const u=[v("div",{class:ae.value},I()),v("div",{class:"q-uploader__list scroll"},A()),T("uploader")];l.isBusy.value===!0&&u.push(v("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[v(mt)]));const F={ref:C,class:ee.value};return G.value===!0&&Object.assign(F,{onDragover:k,onDragleave:m}),v("div",F,u)}}const Tl=kl(Rt),Dl=({name:e,props:r,emits:n,injectPlugin:o})=>ye({name:e,props:{...Ll,...r},emits:il(n)===!0?{...Tl,...n}:[...Rt,...n],setup(h,{expose:i}){return Ml(o,i)}});function ie(e){return typeof e=="function"?e:()=>e}const Ul="QUploader",Pl={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},Hl=["factoryFailed","uploaded","failed","uploading"];function Nl({props:e,emit:r,helpers:n}){const o=M([]),h=M([]),i=M(0),z=f(()=>({url:ie(e.url),method:ie(e.method),headers:ie(e.headers),formFields:ie(e.formFields),fieldName:ie(e.fieldName),withCredentials:ie(e.withCredentials),sendRaw:ie(e.sendRaw),batch:ie(e.batch)})),p=f(()=>i.value>0),y=f(()=>h.value.length!==0);let R;function g(){o.value.forEach(l=>{l.abort()}),h.value.length!==0&&(R=!0)}function x(){const l=n.queuedFiles.value.slice(0);n.queuedFiles.value=[],z.value.batch(l)?C(l):l.forEach(V=>{C([V])})}function C(l){if(i.value++,typeof e.factory!="function"){b(l,{});return}const V=e.factory(l);if(!V)r("factoryFailed",new Error("QUploader: factory() does not return properly"),l),i.value--;else if(typeof V.catch=="function"&&typeof V.then=="function"){h.value.push(V);const S=k=>{n.isAlive()===!0&&(h.value=h.value.filter(m=>m!==V),h.value.length===0&&(R=!1),n.queuedFiles.value=n.queuedFiles.value.concat(l),l.forEach(m=>{n.updateFileStatus(m,"failed")}),r("factoryFailed",k,l),i.value--)};V.then(k=>{R===!0?S(new Error("Aborted")):n.isAlive()===!0&&(h.value=h.value.filter(m=>m!==V),b(l,k))}).catch(S)}else b(l,V||{})}function b(l,V){const S=new FormData,k=new XMLHttpRequest,m=(w,ee)=>V[w]!==void 0?ie(V[w])(ee):z.value[w](ee),U=m("url",l);if(!U){console.error("q-uploader: invalid or no URL specified"),i.value--;return}const T=m("formFields",l);T!==void 0&&T.forEach(w=>{S.append(w.name,w.value)});let Z=0,_=0,E=0,X=0,O;k.upload.addEventListener("progress",w=>{if(O===!0)return;const ee=Math.min(X,w.loaded);n.uploadedSize.value+=ee-E,E=ee;let ae=E-_;for(let te=Z;ae>0&&te<l.length;te++){const K=l[te];if(ae>K.size)ae-=K.size,Z++,_+=K.size,n.updateFileStatus(K,"uploading",K.size);else{n.updateFileStatus(K,"uploading",ae);return}}},!1),k.onreadystatechange=()=>{k.readyState<4||(k.status&&k.status<400?(n.uploadedFiles.value=n.uploadedFiles.value.concat(l),l.forEach(w=>{n.updateFileStatus(w,"uploaded")}),r("uploaded",{files:l,xhr:k})):(O=!0,n.uploadedSize.value-=E,n.queuedFiles.value=n.queuedFiles.value.concat(l),l.forEach(w=>{n.updateFileStatus(w,"failed")}),r("failed",{files:l,xhr:k})),i.value--,o.value=o.value.filter(w=>w!==k))},k.open(m("method",l),U),m("withCredentials",l)===!0&&(k.withCredentials=!0);const D=m("headers",l);D!==void 0&&D.forEach(w=>{k.setRequestHeader(w.name,w.value)});const G=m("sendRaw",l);l.forEach(w=>{n.updateFileStatus(w,"uploading",0),G!==!0&&S.append(m("fieldName",w),w,w.name),w.xhr=k,w.__abort=()=>{k.abort()},X+=w.size}),r("uploading",{files:l,xhr:k}),o.value.push(k),G===!0?k.send(new Blob(l)):k.send(S)}return{isUploading:p,isBusy:y,abort:g,upload:x}}const $l={name:Ul,props:Pl,emits:Hl,injectPlugin:Nl},ua=Dl($l);let Pe=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const r=document.createElement("div");Object.assign(r.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(r),e.scrollLeft=-1e3,Pe=e.scrollLeft>=0,e.remove()}const ue=1e3,jl=["start","center","end","start-force","center-force","end-force"],Et=Array.prototype.filter,Ql=window.getComputedStyle(document.body).overflowAnchor===void 0?rl:function(e,r){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const n=e.children||[];Et.call(n,h=>h.dataset&&h.dataset.qVsAnchor!==void 0).forEach(h=>{delete h.dataset.qVsAnchor});const o=n[r];o?.dataset&&(o.dataset.qVsAnchor="")}))};function ze(e,r){return e+r}function We(e,r,n,o,h,i,z,p){const y=e===window?document.scrollingElement||document.documentElement:e,R=h===!0?"offsetWidth":"offsetHeight",g={scrollStart:0,scrollViewSize:-z-p,scrollMaxSize:0,offsetStart:-z,offsetEnd:-p};if(h===!0?(e===window?(g.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,g.scrollViewSize+=document.documentElement.clientWidth):(g.scrollStart=y.scrollLeft,g.scrollViewSize+=y.clientWidth),g.scrollMaxSize=y.scrollWidth,i===!0&&(g.scrollStart=(Pe===!0?g.scrollMaxSize-g.scrollViewSize:0)-g.scrollStart)):(e===window?(g.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,g.scrollViewSize+=document.documentElement.clientHeight):(g.scrollStart=y.scrollTop,g.scrollViewSize+=y.clientHeight),g.scrollMaxSize=y.scrollHeight),n!==null)for(let x=n.previousElementSibling;x!==null;x=x.previousElementSibling)x.classList.contains("q-virtual-scroll--skip")===!1&&(g.offsetStart+=x[R]);if(o!==null)for(let x=o.nextElementSibling;x!==null;x=x.nextElementSibling)x.classList.contains("q-virtual-scroll--skip")===!1&&(g.offsetEnd+=x[R]);if(r!==e){const x=y.getBoundingClientRect(),C=r.getBoundingClientRect();h===!0?(g.offsetStart+=C.left-x.left,g.offsetEnd-=C.width):(g.offsetStart+=C.top-x.top,g.offsetEnd-=C.height),e!==window&&(g.offsetStart+=g.scrollStart),g.offsetEnd+=g.scrollMaxSize-g.offsetStart}return g}function yt(e,r,n,o){r==="end"&&(r=(e===window?document.body:e)[n===!0?"scrollWidth":"scrollHeight"]),e===window?n===!0?(o===!0&&(r=(Pe===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-r),window.scrollTo(r,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,r):n===!0?(o===!0&&(r=(Pe===!0?e.scrollWidth-e.offsetWidth:0)-r),e.scrollLeft=r):e.scrollTop=r}function Re(e,r,n,o){if(n>=o)return 0;const h=r.length,i=Math.floor(n/ue),z=Math.floor((o-1)/ue)+1;let p=e.slice(i,z).reduce(ze,0);return n%ue!==0&&(p-=r.slice(i*ue,n).reduce(ze,0)),o%ue!==0&&o!==h&&(p-=r.slice(o,z*ue).reduce(ze,0)),p}const Lt={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},na=Object.keys(Lt),_t={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...Lt};function Kl({virtualScrollLength:e,getVirtualScrollTarget:r,getVirtualScrollEl:n,virtualScrollItemSizeComputed:o}){const h=Ve(),{props:i,emit:z,proxy:p}=h,{$q:y}=p;let R,g,x,C=[],b;const l=M(0),V=M(0),S=M({}),k=M(null),m=M(null),U=M(null),T=M({from:0,to:0}),Z=f(()=>i.tableColspan!==void 0?i.tableColspan:100);o===void 0&&(o=f(()=>i.virtualScrollItemSize));const _=f(()=>o.value+";"+i.virtualScrollHorizontal),E=f(()=>_.value+";"+i.virtualScrollSliceRatioBefore+";"+i.virtualScrollSliceRatioAfter);pe(E,()=>{K()}),pe(_,X);function X(){te(g,!0)}function O(a){te(a===void 0?g:a)}function D(a,s){const q=r();if(q==null||q.nodeType===8)return;const L=We(q,n(),k.value,m.value,i.virtualScrollHorizontal,y.lang.rtl,i.virtualScrollStickySizeStart,i.virtualScrollStickySizeEnd);x!==L.scrollViewSize&&K(L.scrollViewSize),w(q,L,Math.min(e.value-1,Math.max(0,parseInt(a,10)||0)),0,jl.indexOf(s)!==-1?s:g!==-1&&a>g?"end":"start")}function G(){const a=r();if(a==null||a.nodeType===8)return;const s=We(a,n(),k.value,m.value,i.virtualScrollHorizontal,y.lang.rtl,i.virtualScrollStickySizeStart,i.virtualScrollStickySizeEnd),q=e.value-1,L=s.scrollMaxSize-s.offsetStart-s.offsetEnd-V.value;if(R===s.scrollStart)return;if(s.scrollMaxSize<=0){w(a,s,0,0);return}x!==s.scrollViewSize&&K(s.scrollViewSize),ee(T.value.from);const Q=Math.floor(s.scrollMaxSize-Math.max(s.scrollViewSize,s.offsetEnd)-Math.min(b[q],s.scrollViewSize/2));if(Q>0&&Math.ceil(s.scrollStart)>=Q){w(a,s,q,s.scrollMaxSize-s.offsetEnd-C.reduce(ze,0));return}let I=0,A=s.scrollStart-s.offsetStart,H=A;if(A<=L&&A+s.scrollViewSize>=l.value)A-=l.value,I=T.value.from,H=A;else for(let u=0;A>=C[u]&&I<q;u++)A-=C[u],I+=ue;for(;A>0&&I<q;)A-=b[I],A>-s.scrollViewSize?(I++,H=A):H=b[I]+A;w(a,s,I,H)}function w(a,s,q,L,Q){const I=typeof Q=="string"&&Q.indexOf("-force")!==-1,A=I===!0?Q.replace("-force",""):Q,H=A!==void 0?A:"start";let u=Math.max(0,q-S.value[H]),F=u+S.value.total;F>e.value&&(F=e.value,u=Math.max(0,F-S.value.total)),R=s.scrollStart;const $=u!==T.value.from||F!==T.value.to;if($===!1&&A===void 0){ce(q);return}const{activeElement:J}=document,j=U.value;$===!0&&j!==null&&j!==J&&j.contains(J)===!0&&(j.addEventListener("focusout",ae),setTimeout(()=>{j?.removeEventListener("focusout",ae)})),Ql(j,q-u);const me=A!==void 0?b.slice(u,q).reduce(ze,0):0;if($===!0){const ge=F>=T.value.from&&u<=T.value.to?T.value.to:F;T.value={from:u,to:ge},l.value=Re(C,b,0,u),V.value=Re(C,b,F,e.value),requestAnimationFrame(()=>{T.value.to!==F&&R===s.scrollStart&&(T.value={from:T.value.from,to:F},V.value=Re(C,b,F,e.value))})}requestAnimationFrame(()=>{if(R!==s.scrollStart)return;$===!0&&ee(u);const ge=b.slice(u,q).reduce(ze,0),he=ge+s.offsetStart+l.value,Le=he+b[q];let Ae=he+L;if(A!==void 0){const He=ge-me,Be=s.scrollStart+He;Ae=I!==!0&&Be<he&&Le<Be+s.scrollViewSize?Be:A==="end"?Le-s.scrollViewSize:he-(A==="start"?0:Math.round((s.scrollViewSize-b[q])/2))}R=Ae,yt(a,Ae,i.virtualScrollHorizontal,y.lang.rtl),ce(q)})}function ee(a){const s=U.value;if(s){const q=Et.call(s.children,u=>u.classList&&u.classList.contains("q-virtual-scroll--skip")===!1),L=q.length,Q=i.virtualScrollHorizontal===!0?u=>u.getBoundingClientRect().width:u=>u.offsetHeight;let I=a,A,H;for(let u=0;u<L;){for(A=Q(q[u]),u++;u<L&&q[u].classList.contains("q-virtual-scroll--with-prev")===!0;)A+=Q(q[u]),u++;H=A-b[I],H!==0&&(b[I]+=H,C[Math.floor(I/ue)]+=H),I++}}}function ae(){U.value?.focus()}function te(a,s){const q=1*o.value;(s===!0||Array.isArray(b)===!1)&&(b=[]);const L=b.length;b.length=e.value;for(let I=e.value-1;I>=L;I--)b[I]=q;const Q=Math.floor((e.value-1)/ue);C=[];for(let I=0;I<=Q;I++){let A=0;const H=Math.min((I+1)*ue,e.value);for(let u=I*ue;u<H;u++)A+=b[u];C.push(A)}g=-1,R=void 0,l.value=Re(C,b,0,T.value.from),V.value=Re(C,b,T.value.to,e.value),a>=0?(ee(T.value.from),fe(()=>{D(a)})):ne()}function K(a){if(a===void 0&&typeof window<"u"){const A=r();A!=null&&A.nodeType!==8&&(a=We(A,n(),k.value,m.value,i.virtualScrollHorizontal,y.lang.rtl,i.virtualScrollStickySizeStart,i.virtualScrollStickySizeEnd).scrollViewSize)}x=a;const s=parseFloat(i.virtualScrollSliceRatioBefore)||0,q=parseFloat(i.virtualScrollSliceRatioAfter)||0,L=1+s+q,Q=a===void 0||a<=0?1:Math.ceil(a/o.value),I=Math.max(1,Q,Math.ceil((i.virtualScrollSliceSize>0?i.virtualScrollSliceSize:10)/L));S.value={total:Math.ceil(I*L),start:Math.ceil(I*s),center:Math.ceil(I*(.5+s)),end:Math.ceil(I*(1+s)),view:Q}}function se(a,s){const q=i.virtualScrollHorizontal===!0?"width":"height",L={["--q-virtual-scroll-item-"+q]:o.value+"px"};return[a==="tbody"?v(a,{class:"q-virtual-scroll__padding",key:"before",ref:k},[v("tr",[v("td",{style:{[q]:`${l.value}px`,...L},colspan:Z.value})])]):v(a,{class:"q-virtual-scroll__padding",key:"before",ref:k,style:{[q]:`${l.value}px`,...L}}),v(a,{class:"q-virtual-scroll__content",key:"content",ref:U,tabindex:-1},s.flat()),a==="tbody"?v(a,{class:"q-virtual-scroll__padding",key:"after",ref:m},[v("tr",[v("td",{style:{[q]:`${V.value}px`,...L},colspan:Z.value})])]):v(a,{class:"q-virtual-scroll__padding",key:"after",ref:m,style:{[q]:`${V.value}px`,...L}})]}function ce(a){g!==a&&(i.onVirtualScroll!==void 0&&z("virtualScroll",{index:a,from:T.value.from,to:T.value.to-1,direction:a<g?"decrease":"increase",ref:p}),g=a)}K();const ne=sl(G,y.platform.is.ios===!0?120:35);cl(()=>{K()});let de=!1;return dl(()=>{de=!0}),fl(()=>{if(de!==!0)return;const a=r();R!==void 0&&a!==void 0&&a!==null&&a.nodeType!==8?yt(a,R,i.virtualScrollHorizontal,y.lang.rtl):D(g)}),Ge(()=>{ne.cancel()}),Object.assign(p,{scrollTo:D,reset:X,refresh:O}),{virtualScrollSliceRange:T,virtualScrollSliceSizeComputed:S,setVirtualScrollSize:K,onVirtualScrollEvt:ne,localResetVirtualScroll:te,padVirtualScroll:se,scrollTo:D,reset:X,refresh:O}}const Wl=ye({name:"QField",inheritAttrs:!1,props:{...Je,tag:{type:String,default:"label"}},emits:Vt,setup(){return At(Bt({tagProp:!0}))}}),Xl={xs:8,sm:10,md:14,lg:20,xl:24},Yl=ye({name:"QChip",props:{...qt,...Ct,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:r,emit:n}){const{proxy:{$q:o}}=Ve(),h=zt(e,o),i=kt(e,Xl),z=f(()=>e.selected===!0||e.icon!==void 0),p=f(()=>e.selected===!0?e.iconSelected||o.iconSet.chip.selected:e.icon),y=f(()=>e.iconRemove||o.iconSet.chip.remove),R=f(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),g=f(()=>{const S=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(S?` text-${S} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(R.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(h.value===!0?" q-chip--dark q-dark":"")}),x=f(()=>{const S=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},k={...S,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||o.lang.label.remove};return{chip:S,remove:k}});function C(S){S.keyCode===13&&b(S)}function b(S){e.disable||(n("update:selected",!e.selected),n("click",S))}function l(S){(S.keyCode===void 0||S.keyCode===13)&&(re(S),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function V(){const S=[];R.value===!0&&S.push(v("div",{class:"q-focus-helper"})),z.value===!0&&S.push(v(Ee,{class:"q-chip__icon q-chip__icon--left",name:p.value}));const k=e.label!==void 0?[v("div",{class:"ellipsis"},[e.label])]:void 0;return S.push(v("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},Ft(r.default,k))),e.iconRight&&S.push(v(Ee,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&S.push(v(Ee,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:y.value,...x.value.remove,onClick:l,onKeyup:l})),S}return()=>{if(e.modelValue===!1)return;const S={class:g.value,style:i.value};return R.value===!0&&Object.assign(S,x.value.chip,{onClick:b,onKeyup:C}),vl("div",S,V(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[ml,e.ripple]])}}}),wt=e=>["add","add-unique","toggle"].includes(e),Gl=".*+?^${}()|[]\\",Jl=Object.keys(Je);function Xe(e,r){if(typeof e=="function")return e;const n=e!==void 0?e:r;return o=>o!==null&&typeof o=="object"&&n in o?o[n]:o}const oa=ye({name:"QSelect",inheritAttrs:!1,props:{..._t,...gl,...Je,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:wt},mapOptions:Boolean,emitValue:Boolean,disableTabSelection:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:_t.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...Vt,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:r,emit:n}){const{proxy:o}=Ve(),{$q:h}=o,i=M(!1),z=M(!1),p=M(-1),y=M(""),R=M(!1),g=M(!1);let x=null,C=null,b,l,V,S=null,k,m,U,T;const Z=M(null),_=M(null),E=M(null),X=M(null),O=M(null),D=hl(e),G=Sl(rt),w=f(()=>Array.isArray(e.options)?e.options.length:0),ee=f(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:ae,virtualScrollSliceSizeComputed:te,localResetVirtualScroll:K,padVirtualScroll:se,onVirtualScrollEvt:ce,scrollTo:ne,setVirtualScrollSize:de}=Kl({virtualScrollLength:w,getVirtualScrollTarget:Ut,getVirtualScrollEl:ot,virtualScrollItemSizeComputed:ee}),a=Bt(),s=f(()=>{const t=e.mapOptions===!0&&e.multiple!==!0,c=e.modelValue!==void 0&&(e.modelValue!==null||t===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const d=e.mapOptions===!0&&b!==void 0?b:[],B=c.map(N=>Dt(N,d));return e.modelValue===null&&t===!0?B.filter(N=>N!==null):B}return c}),q=f(()=>{const t={};return Jl.forEach(c=>{const d=e[c];d!==void 0&&(t[c]=d)}),t}),L=f(()=>e.optionsDark===null?a.isDark.value:e.optionsDark),Q=f(()=>ht(s.value)),I=f(()=>{let t="q-field__input q-placeholder col";return e.hideSelected===!0||s.value.length===0?[t,e.inputClass]:(t+=" q-field__input--padding",e.inputClass===void 0?t:[t,e.inputClass])}),A=f(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),H=f(()=>w.value===0),u=f(()=>s.value.map(t=>le.value(t)).join(", ")),F=f(()=>e.displayValue!==void 0?e.displayValue:u.value),$=f(()=>e.optionsHtml===!0?()=>!0:t=>t?.html===!0),J=f(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||s.value.some($.value))),j=f(()=>a.focused.value===!0?e.tabindex:-1),me=f(()=>{const t={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":i.value===!0?"true":"false","aria-controls":`${a.targetUid.value}_lb`};return p.value>=0&&(t["aria-activedescendant"]=`${a.targetUid.value}_${p.value}`),t}),ge=f(()=>({id:`${a.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),he=f(()=>s.value.map((t,c)=>({index:c,opt:t,html:$.value(t),selected:!0,removeAtIndex:Tt,toggleOption:Se,tabindex:j.value}))),Le=f(()=>{if(w.value===0)return[];const{from:t,to:c}=ae.value;return e.options.slice(t,c).map((d,B)=>{const N=_e.value(d)===!0,P=$e(d)===!0,Y=t+B,W={clickable:!0,active:P,activeClass:Be.value,manualFocus:!0,focused:!1,disable:N,tabindex:-1,dense:e.optionsDense,dark:L.value,role:"option","aria-selected":P===!0?"true":"false",id:`${a.targetUid.value}_${Y}`,onClick:()=>{Se(d)}};return N!==!0&&(p.value===Y&&(W.focused=!0),h.platform.is.desktop===!0&&(W.onMousemove=()=>{i.value===!0&&we(Y)})),{index:Y,opt:d,html:$.value(d),label:le.value(d),selected:W.active,focused:W.focused,toggleOption:Se,setOptionIndex:we,itemProps:W}})}),Ae=f(()=>e.dropdownIcon!==void 0?e.dropdownIcon:h.iconSet.arrow.dropdown),He=f(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Be=f(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),oe=f(()=>Xe(e.optionValue,"value")),le=f(()=>Xe(e.optionLabel,"label")),_e=f(()=>Xe(e.optionDisable,"disable")),Me=f(()=>s.value.map(oe.value)),Mt=f(()=>{const t={onInput:rt,onChange:G,onKeydown:nt,onKeyup:at,onKeypress:ut,onFocus:tt,onClick(c){l===!0&&ve(c)}};return t.onCompositionstart=t.onCompositionupdate=t.onCompositionend=G,t});pe(s,t=>{b=t,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&a.innerLoading.value!==!0&&(z.value!==!0&&i.value!==!0||Q.value!==!0)&&(V!==!0&&Fe(),(z.value===!0||i.value===!0)&&xe(""))},{immediate:!0}),pe(()=>e.fillInput,Fe),pe(i,je),pe(w,Jt);function Ze(t){return e.emitValue===!0?oe.value(t):t}function Ne(t){if(t!==-1&&t<s.value.length)if(e.multiple===!0){const c=e.modelValue.slice();n("remove",{index:t,value:c.splice(t,1)[0]}),n("update:modelValue",c)}else n("update:modelValue",null)}function Tt(t){Ne(t),a.focus()}function et(t,c){const d=Ze(t);if(e.multiple!==!0){e.fillInput===!0&&Ie(le.value(t),!0,!0),n("update:modelValue",d);return}if(s.value.length===0){n("add",{index:0,value:d}),n("update:modelValue",e.multiple===!0?[d]:d);return}if(c===!0&&$e(t)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const B=e.modelValue.slice();n("add",{index:B.length,value:d}),B.push(d),n("update:modelValue",B)}function Se(t,c){if(a.editable.value!==!0||t===void 0||_e.value(t)===!0)return;const d=oe.value(t);if(e.multiple!==!0){c!==!0&&(Ie(e.fillInput===!0?le.value(t):"",!0,!0),be()),_.value?.focus(),(s.value.length===0||Oe(oe.value(s.value[0]),d)!==!0)&&n("update:modelValue",e.emitValue===!0?d:t);return}if((l!==!0||R.value===!0)&&a.focus(),tt(),s.value.length===0){const P=e.emitValue===!0?d:t;n("add",{index:0,value:P}),n("update:modelValue",e.multiple===!0?[P]:P);return}const B=e.modelValue.slice(),N=Me.value.findIndex(P=>Oe(P,d));if(N!==-1)n("remove",{index:N,value:B.splice(N,1)[0]});else{if(e.maxValues!==void 0&&B.length>=e.maxValues)return;const P=e.emitValue===!0?d:t;n("add",{index:B.length,value:P}),B.push(P)}n("update:modelValue",B)}function we(t){if(h.platform.is.desktop!==!0)return;const c=t!==-1&&t<w.value?t:-1;p.value!==c&&(p.value=c)}function Te(t=1,c){if(i.value===!0){let d=p.value;do d=bt(d+t,-1,w.value-1);while(d!==-1&&d!==p.value&&_e.value(e.options[d])===!0);p.value!==d&&(we(d),ne(d),c!==!0&&e.useInput===!0&&e.fillInput===!0&&De(d>=0?le.value(e.options[d]):k,!0))}}function Dt(t,c){const d=B=>Oe(oe.value(B),t);return e.options.find(d)||c.find(d)||t}function $e(t){const c=oe.value(t);return Me.value.find(d=>Oe(d,c))!==void 0}function tt(t){e.useInput===!0&&_.value!==null&&(t===void 0||_.value===t.target&&t.target.value===u.value)&&_.value.select()}function lt(t){_l(t,27)===!0&&i.value===!0&&(ve(t),be(),Fe()),n("keyup",t)}function at(t){const{value:c}=t.target;if(t.keyCode!==void 0){lt(t);return}if(t.target.value="",x!==null&&(clearTimeout(x),x=null),C!==null&&(clearTimeout(C),C=null),Fe(),typeof c=="string"&&c.length!==0){const d=c.toLocaleLowerCase(),B=P=>{const Y=e.options.find(W=>String(P.value(W)).toLocaleLowerCase()===d);return Y===void 0?!1:(s.value.indexOf(Y)===-1?Se(Y):be(),!0)},N=P=>{B(oe)!==!0&&P!==!0&&B(le)!==!0&&xe(c,!0,()=>N(!0))};N()}else a.clearValue(t)}function ut(t){n("keypress",t)}function nt(t){if(n("keydown",t),bl(t)===!0)return;const c=y.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),d=t.shiftKey!==!0&&e.disableTabSelection!==!0&&e.multiple!==!0&&(p.value!==-1||c===!0);if(t.keyCode===27){Ke(t);return}if(t.keyCode===9&&d===!1){Ce();return}if(t.target===void 0||t.target.id!==a.targetUid.value||a.editable.value!==!0)return;if(t.keyCode===40&&a.innerLoading.value!==!0&&i.value===!1){re(t),ke();return}if(t.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&y.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?Ne(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&n("update:modelValue",null);return}(t.keyCode===35||t.keyCode===36)&&(typeof y.value!="string"||y.value.length===0)&&(re(t),p.value=-1,Te(t.keyCode===36?1:-1,e.multiple)),(t.keyCode===33||t.keyCode===34)&&te.value!==void 0&&(re(t),p.value=Math.max(-1,Math.min(w.value,p.value+(t.keyCode===33?-1:1)*te.value.view)),Te(t.keyCode===33?1:-1,e.multiple)),(t.keyCode===38||t.keyCode===40)&&(re(t),Te(t.keyCode===38?-1:1,e.multiple));const B=w.value;if((U===void 0||T<Date.now())&&(U=""),B>0&&e.useInput!==!0&&t.key!==void 0&&t.key.length===1&&t.altKey===!1&&t.ctrlKey===!1&&t.metaKey===!1&&(t.keyCode!==32||U.length!==0)){i.value!==!0&&ke(t);const N=t.key.toLocaleLowerCase(),P=U.length===1&&U[0]===N;T=Date.now()+1500,P===!1&&(re(t),U+=N);const Y=new RegExp("^"+U.split("").map(Qe=>Gl.indexOf(Qe)!==-1?"\\"+Qe:Qe).join(".*"),"i");let W=p.value;if(P===!0||W<0||Y.test(le.value(e.options[W]))!==!0)do W=bt(W+1,-1,B-1);while(W!==p.value&&(_e.value(e.options[W])===!0||Y.test(le.value(e.options[W]))!==!0));p.value!==W&&fe(()=>{we(W),ne(W),W>=0&&e.useInput===!0&&e.fillInput===!0&&De(le.value(e.options[W]),!0)});return}if(!(t.keyCode!==13&&(t.keyCode!==32||e.useInput===!0||U!=="")&&(t.keyCode!==9||d===!1))){if(t.keyCode!==9&&re(t),p.value!==-1&&p.value<B){Se(e.options[p.value]);return}if(c===!0){const N=(P,Y)=>{if(Y){if(wt(Y)!==!0)return}else Y=e.newValueMode;if(Ie("",e.multiple!==!0,!0),P==null)return;(Y==="toggle"?Se:et)(P,Y==="add-unique"),e.multiple!==!0&&(_.value?.focus(),be())};if(e.onNewValue!==void 0?n("newValue",y.value,N):N(y.value),e.multiple!==!0)return}i.value===!0?Ce():a.innerLoading.value!==!0&&ke()}}function ot(){return l===!0?O.value:E.value!==null&&E.value.contentEl!==null?E.value.contentEl:void 0}function Ut(){return ot()}function Pt(){return e.hideSelected===!0?[]:r["selected-item"]!==void 0?he.value.map(t=>r["selected-item"](t)).slice():r.selected!==void 0?[].concat(r.selected()):e.useChips===!0?he.value.map((t,c)=>v(Yl,{key:"option-"+c,removable:a.editable.value===!0&&_e.value(t.opt)!==!0,dense:!0,textColor:e.color,tabindex:j.value,onRemove(){t.removeAtIndex(c)}},()=>v("span",{class:"ellipsis",[t.html===!0?"innerHTML":"textContent"]:le.value(t.opt)}))):[v("span",{class:"ellipsis",[J.value===!0?"innerHTML":"textContent"]:F.value})]}function it(){if(H.value===!0)return r["no-option"]!==void 0?r["no-option"]({inputValue:y.value}):void 0;const t=r.option!==void 0?r.option:d=>v(zl,{key:d.index,...d.itemProps},()=>v(ql,()=>v(Vl,()=>v("span",{[d.html===!0?"innerHTML":"textContent"]:d.label}))));let c=se("div",Le.value.map(t));return r["before-options"]!==void 0&&(c=r["before-options"]().concat(c)),xl(r["after-options"],c)}function Ht(t,c){const d=c===!0?{...me.value,...a.splitAttrs.attributes.value}:void 0,B={ref:c===!0?_:void 0,key:"i_t",class:I.value,style:e.inputStyle,value:y.value!==void 0?y.value:"",type:"search",...d,id:c===!0?a.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":t===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Mt.value};return t!==!0&&l===!0&&(Array.isArray(B.class)===!0?B.class=[...B.class,"no-pointer-events"]:B.class+=" no-pointer-events"),v("input",B)}function rt(t){x!==null&&(clearTimeout(x),x=null),C!==null&&(clearTimeout(C),C=null),!(t&&t.target&&t.target.qComposing===!0)&&(De(t.target.value||""),V=!0,k=y.value,a.focused.value!==!0&&(l!==!0||R.value===!0)&&a.focus(),e.onFilter!==void 0&&(x=setTimeout(()=>{x=null,xe(y.value)},e.inputDebounce)))}function De(t,c){y.value!==t&&(y.value=t,c===!0||e.inputDebounce===0||e.inputDebounce==="0"?n("inputValue",t):C=setTimeout(()=>{C=null,n("inputValue",t)},e.inputDebounce))}function Ie(t,c,d){V=d!==!0,e.useInput===!0&&(De(t,!0),(c===!0||d!==!0)&&(k=t),c!==!0&&xe(t))}function xe(t,c,d){if(e.onFilter===void 0||c!==!0&&a.focused.value!==!0)return;a.innerLoading.value===!0?n("filterAbort"):(a.innerLoading.value=!0,g.value=!0),t!==""&&e.multiple!==!0&&s.value.length!==0&&V!==!0&&t===le.value(s.value[0])&&(t="");const B=setTimeout(()=>{i.value===!0&&(i.value=!1)},10);S!==null&&clearTimeout(S),S=B,n("filter",t,(N,P)=>{(c===!0||a.focused.value===!0)&&S===B&&(clearTimeout(S),typeof N=="function"&&N(),g.value=!1,fe(()=>{a.innerLoading.value=!1,a.editable.value===!0&&(c===!0?i.value===!0&&be():i.value===!0?je(!0):i.value=!0),typeof P=="function"&&fe(()=>{P(o)}),typeof d=="function"&&fe(()=>{d(o)})}))},()=>{a.focused.value===!0&&S===B&&(clearTimeout(S),a.innerLoading.value=!1,g.value=!1),i.value===!0&&(i.value=!1)})}function Nt(){return v(Fl,{ref:E,class:A.value,style:e.popupContentStyle,modelValue:i.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&H.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:L.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:He.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...ge.value,onScrollPassive:ce,onBeforeShow:ct,onBeforeHide:$t,onShow:jt},it)}function $t(t){dt(t),Ce()}function jt(){de()}function Qt(t){ve(t),_.value?.focus(),R.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Kt(t){ve(t),fe(()=>{R.value=!1})}function Wt(){const t=[v(Wl,{class:`col-auto ${a.fieldClass.value}`,...q.value,for:a.targetUid.value,dark:L.value,square:!0,loading:g.value,itemAligned:!1,filled:!0,stackLabel:y.value.length!==0,...a.splitAttrs.listeners.value,onFocus:Qt,onBlur:Kt},{...r,rawControl:()=>a.getControl(!0),before:void 0,after:void 0})];return i.value===!0&&t.push(v("div",{ref:O,class:A.value+" scroll",style:e.popupContentStyle,...ge.value,onClick:Ke,onScrollPassive:ce},it())),v(wl,{ref:X,modelValue:z.value,position:e.useInput===!0?"top":void 0,transitionShow:m,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:ct,onBeforeHide:Xt,onHide:Yt,onShow:Gt},()=>v("div",{class:"q-select__dialog"+(L.value===!0?" q-select__dialog--dark q-dark":"")+(R.value===!0?" q-select__dialog--focused":"")},t))}function Xt(t){dt(t),X.value!==null&&X.value.__updateRefocusTarget(a.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),a.focused.value=!1}function Yt(t){be(),a.focused.value===!1&&n("blur",t),Fe()}function Gt(){const t=document.activeElement;(t===null||t.id!==a.targetUid.value)&&_.value!==null&&_.value!==t&&_.value.focus(),de()}function Ce(){z.value!==!0&&(p.value=-1,i.value===!0&&(i.value=!1),a.focused.value===!1&&(S!==null&&(clearTimeout(S),S=null),a.innerLoading.value===!0&&(n("filterAbort"),a.innerLoading.value=!1,g.value=!1)))}function ke(t){a.editable.value===!0&&(l===!0?(a.onControlFocusin(t),z.value=!0,fe(()=>{a.focus()})):a.focus(),e.onFilter!==void 0?xe(y.value):(H.value!==!0||r["no-option"]!==void 0)&&(i.value=!0))}function be(){z.value=!1,Ce()}function Fe(){e.useInput===!0&&Ie(e.multiple!==!0&&e.fillInput===!0&&s.value.length!==0&&le.value(s.value[0])||"",!0,!0)}function je(t){let c=-1;if(t===!0){if(s.value.length!==0){const d=oe.value(s.value[0]);c=e.options.findIndex(B=>Oe(oe.value(B),d))}K(c)}we(c)}function Jt(t,c){i.value===!0&&a.innerLoading.value===!1&&(K(-1,!0),fe(()=>{i.value===!0&&a.innerLoading.value===!1&&(t>c?K():je(!0))}))}function st(){z.value===!1&&E.value!==null&&E.value.updatePosition()}function ct(t){t!==void 0&&ve(t),n("popupShow",t),a.hasPopupOpen=!0,a.onControlFocusin(t)}function dt(t){t!==void 0&&ve(t),n("popupHide",t),a.hasPopupOpen=!1,a.onControlFocusout(t)}function ft(){l=h.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?r["no-option"]!==void 0||e.onFilter!==void 0||H.value===!1:!0),m=h.platform.is.ios===!0&&l===!0&&e.useInput===!0?"fade":e.transitionShow}return pl(ft),yl(st),ft(),Ge(()=>{x!==null&&clearTimeout(x),C!==null&&clearTimeout(C)}),Object.assign(o,{showPopup:ke,hidePopup:be,removeAtIndex:Ne,add:et,toggleOption:Se,getOptionIndex:()=>p.value,setOptionIndex:we,moveOptionSelection:Te,filter:xe,updateMenuPosition:st,updateInputValue:Ie,isOptionSelected:$e,getEmittingOptionValue:Ze,isOptionDisabled:(...t)=>_e.value.apply(null,t)===!0,getOptionValue:(...t)=>oe.value.apply(null,t),getOptionLabel:(...t)=>le.value.apply(null,t)}),Object.assign(a,{innerValue:s,fieldClass:f(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:Z,targetRef:_,hasValue:Q,showPopup:ke,floatingLabel:f(()=>e.hideSelected!==!0&&Q.value===!0||typeof y.value=="number"||y.value.length!==0||ht(e.displayValue)),getControlChild:()=>{if(a.editable.value!==!1&&(z.value===!0||H.value!==!0||r["no-option"]!==void 0))return l===!0?Wt():Nt();a.hasPopupOpen===!0&&(a.hasPopupOpen=!1)},controlEvents:{onFocusin(t){a.onControlFocusin(t)},onFocusout(t){a.onControlFocusout(t,()=>{Fe(),Ce()})},onClick(t){if(Ke(t),l!==!0&&i.value===!0){Ce(),_.value?.focus();return}ke(t)}},getControl:t=>{const c=Pt(),d=t===!0||z.value!==!0||l!==!0;if(e.useInput===!0)c.push(Ht(t,d));else if(a.editable.value===!0){const N=d===!0?me.value:void 0;c.push(v("input",{ref:d===!0?_:void 0,key:"d_t",class:"q-select__focus-target",id:d===!0?a.targetUid.value:void 0,value:F.value,readonly:!0,"data-autofocus":t===!0||e.autofocus===!0||void 0,...N,onKeydown:nt,onKeyup:lt,onKeypress:ut})),d===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&c.push(v("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:at}))}if(D.value!==void 0&&e.disable!==!0&&Me.value.length!==0){const N=Me.value.map(P=>v("option",{value:P,selected:!0}));c.push(v("select",{class:"hidden",name:D.value,multiple:e.multiple},N))}const B=e.useInput===!0||d!==!0?void 0:a.splitAttrs.attributes.value;return v("div",{class:"q-field__native row items-center",...B,...a.splitAttrs.listeners.value},c)},getInnerAppend:()=>e.loading!==!0&&g.value!==!0&&e.hideDropdownIcon!==!0?[v(Ee,{class:"q-select__dropdown-icon"+(i.value===!0?" rotate-180":""),name:Ae.value})]:null}),At(a)}});export{ua as Q,Vl as a,Il as b,aa as c,Kl as d,na as e,oa as f,Yl as g,Pe as r,_t as u};

import{k as h,bz as v,ad as w,n as y}from"./index-t5JGJ5mJ.js";function S(){return h(v)}const b=w("api",()=>{const s=S(),o=()=>window.getApi?window.getApi():null;return{apiCallWithLoading:async(u,g="GET",p=null,c="Loading...")=>{try{if(typeof u!="string")throw new TypeError(`Invalid URL: ${u}`);s.loading.show({message:c});const n={method:g,url:u,data:p};return await o()(n)}catch(n){throw console.error("Error during API call:",n),n}finally{s.loading.hide()}},getApi:o,getAddr:()=>window.getBaseURL?window.getBaseURL():window.location.origin}}),U=w("status",()=>{const{apiCallWithLoading:s}=b(),o=y({playlistMode:!1,nics:[],darkmode:!1,current:{id:"",name:"",type:""},playlist:[],device:{audiocurrentdevice:"",audiodevicelist:[]},fullscreen:!1,logo:{show:!1,file:"",width:0,height:0,x:0,y:0},player:{event:"",buffering:0,media_path:"",filename:"",volume:100,speed:1,duration:0,time:0,position:0,fullscreen:!1,playing:!1,is_image:!1,image_path:null},background:"",image_time:0}),l=async(a,t)=>{const e=await s("/status/update","POST",{key:a,value:t},`Updating status for key "${a}"...`);if(e.data.pStatus)for(const[i,r]of Object.entries(e.data.pStatus))o.value[i]!==void 0?o.value[i]=r:console.warn(`Unknown key "${i}" in pStatus`);return e};return{pStatus:o,updateStatus:l,setAudioDevice:async a=>{const t=await s("/player/setaudiodevice","PUT",{deviceId:a},"Setting audio device...");return o.value.device.audiodevice=a,t},isBright:a=>{let t=a.trim().toLowerCase();if(t==="white"||t==="#fff"||t==="#ffffff"||t==="rgb(255,255,255)")return!0;if(t.startsWith("#")){let e=t.replace("#","");if(e.length===3&&(e=e.split("").map(f=>f+f).join("")),e.length!==6)return!1;const i=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),d=parseInt(e.substring(4,6),16);return(i*299+r*587+d*114)/1e3>186}if(t.startsWith("rgb")){const e=t.match(/rgb\((\d+),(\d+),(\d+)\)/);if(e){const i=parseInt(e[1]),r=parseInt(e[2]),d=parseInt(e[3]);return(i*299+r*587+d*114)/1e3>186}}return!1},updateImageTime:async a=>{const t=await s(`/status/image_time/${a}`,"GET",null,`Updating image time to ${a}...`);t.data.pStatus&&(o.value.image_time=t.data.pStatus.image_time)},updateLogo:async a=>{const t=await s(`/status/logo/sel/${encodeURIComponent(a)}`,"GET",null,`Updating logo to ${a}...`);t.data.pStatus&&(o.value.logo=t.data.pStatus.logo),await l("logo",o.value.logo)},updateLogoSize:async(a,t)=>{const e=await s("/status/logo/size","PUT",{width:a,height:t},"Updating logo size...");if(!e.data.pStatus||!e.data.pStatus.logo){console.error("Failed to update logo size:",e.data);return}o.value.logo=e.data.pStatus.logo,await l("logo",o.value.logo)},updateLogoVisibility:async a=>{const t=await s(`/status/logo/show/${a?"true":"false"}`,"GET",null,`Updating logo visibility to ${a?"visible":"hidden"}...`);o.value.logo=t.data.pStatus.logo,console.log(`Logo visibility updated to ${a?"visible":"hidden"}`)}}});export{b as a,S as b,U as u};

import{i as j,Z as F,j as R,_ as U,n as _,q as h,v as A,a9 as I,z as C,B as D,ae as K,y as H,Y as W,s as G,H as X,c as Y,o as z,w as o,a as t,h as B,g as q,b as w,Q as E,af as Q,ag as Z,t as J,e as ee,W as te,P as S,X as ae,f as L,ad as le}from"./index-D06vnydI.js";import{T as se}from"./TouchPan-Bk3tvTHN.js";import{u as re,a as oe}from"./useApi-DyMPQWJu.js";import{_ as $}from"./delayedTooltip-DIz3BjMV.js";import{u as ie}from"./use-dialog-plugin-component-Dw_I3MMD.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./position-engine-CCjzhR2y.js";const ne=j({name:"QSplitter",props:{...F,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:a,emit:c}){const{proxy:{$q:s}}=R(),d=U(e,s),i=_(null),f={before:_(null),after:_(null)},b=h(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(d.value===!0?" q-splitter--dark":"")),y=h(()=>e.horizontal===!0?"height":"width"),r=h(()=>e.reverse!==!0?"before":"after"),l=h(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function n(u){return(e.unit==="%"?u:Math.round(u))+e.unit}const v=h(()=>({[r.value]:{[y.value]:n(e.modelValue)}}));let p,m,g,x,P;function N(u){if(u.isFirst===!0){const k=i.value.getBoundingClientRect()[y.value];p=e.horizontal===!0?"up":"left",m=e.unit==="%"?100:k,g=Math.min(m,l.value[1],Math.max(l.value[0],e.modelValue)),x=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:s.lang.rtl===!0?-1:1)*(e.unit==="%"?k===0?0:100/k:1),i.value.classList.add("q-splitter--active");return}if(u.isFinal===!0){P!==e.modelValue&&c("update:modelValue",P),i.value.classList.remove("q-splitter--active");return}const V=g+x*(u.direction===p?-1:1)*u.distance[e.horizontal===!0?"y":"x"];P=Math.min(m,l.value[1],Math.max(l.value[0],V)),f[r.value].value.style[y.value]=n(P),e.emitImmediately===!0&&e.modelValue!==P&&c("update:modelValue",P)}const O=h(()=>[[se,N,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function T(u,V){u<V[0]?c("update:modelValue",V[0]):u>V[1]&&c("update:modelValue",V[1])}return A(()=>e.modelValue,u=>{T(u,l.value)}),A(()=>e.limits,()=>{I(()=>{T(e.modelValue,l.value)})}),()=>{const u=[C("div",{ref:f.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:v.value.before},D(a.before)),C("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[K("div",{class:"q-splitter__separator-area absolute-full"},D(a.separator),"sep",e.disable!==!0,()=>O.value)]),C("div",{ref:f.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:v.value.after},D(a.after))];return C("div",{class:b.value,ref:i},H(a.default,u))}}}),ue=W("Playlist",()=>{const{apiCallWithLoading:e}=re(),a=_([]),c=_(0),s=_(null),d=_(!1),i=async()=>{const r=await e("/playlist","GET",null,"Fetching playlist...");a.value=r.data,console.log("Playlist fetched successfully:",a.value)};return{playlist:a,currentIndex:c,currentPlaylist:s,isPlaying:d,getPlaylist:i,addPlaylist:async r=>{const l=await e("/playlist","POST",r,"Creating playlist...");if(l.status===201)return console.log("Playlist added successfully:",l.data),await i(),l.data;throw console.error("Failed to add playlist:",l.statusText),new Error(l.statusText)},updatePlaylist:async(r,l)=>{const n=await e(`/playlist/${r}`,"PUT",l,"Updating playlist...");if(n.status===200){const v=a.value.findIndex(p=>p._id===r);return v!==-1&&(a.value[v]=n.data),s.value?._id===r&&(s.value=n.data),console.log("Playlist updated successfully:",n.data),await i(),n.data}else throw console.error("Failed to update playlist:",n.statusText),new Error(n.statusText)},deletePlaylist:async r=>{const l=await e(`/playlist/${r}`,"DELETE",null,"Deleting playlist...");if(l.status===200)return a.value=a.value.filter(n=>n._id!==r),s.value?._id===r&&(s.value=null),console.log("Playlist deleted successfully:",r),await i(),!0;throw console.error("Failed to delete playlist:",l.statusText),new Error(l.statusText)}}}),de={class:"text-caption text-grey-6"},ce={__name:"addPlaylist",setup(e){const{dialogRef:a,onDialogOK:c,onDialogCancel:s}=ie(),d=ue(),{playlist:i}=G(d),f=_(""),b=_(""),y=_(!1),r=()=>`playlist ${(i.value?.length||0)+1}`;X(()=>{f.value=r()});const l=async()=>{if(!(!v.value||p.value))try{y.value=!0;const m={name:f.value.trim(),description:b.value.trim(),items:[]};await d.addPlaylist(m),c(m)}catch(m){console.error("플레이리스트 추가 실패:",m)}finally{y.value=!1}},n=()=>{s()},v=h(()=>f.value.trim().length>0),p=h(()=>i.value?i.value.some(m=>m.name.toLowerCase()===f.value.trim().toLowerCase()):!1);return(m,g)=>(z(),Y(ae,{ref_key:"dialogRef",ref:a,persistent:""},{default:o(()=>[t(B,{style:{"min-width":"400px"}},{default:o(()=>[t(q,{class:"row items-center"},{default:o(()=>[t(E,{name:"playlist_add",size:"2em",color:"primary"}),g[2]||(g[2]=w("div",{class:"text-h6 q-ml-md"},"새 플레이리스트 만들기",-1))]),_:1,__:[2]}),t(q,{class:"q-pt-none"},{default:o(()=>[t(Q,{modelValue:f.value,"onUpdate:modelValue":g[0]||(g[0]=x=>f.value=x),label:"플레이리스트 이름",filled:"",dense:"",autofocus:"",error:!v.value||p.value,"error-message":v.value?p.value?"이미 존재하는 이름입니다.":"":"플레이리스트 이름을 입력해주세요.",onKeyup:Z(l,["enter"])},{hint:o(()=>[w("div",de," 현재 "+J(ee(i)?.length||0)+"개의 플레이리스트가 있습니다 ",1)]),_:1},8,["modelValue","error","error-message"]),t(Q,{modelValue:b.value,"onUpdate:modelValue":g[1]||(g[1]=x=>b.value=x),label:"설명 (선택사항)",outlined:"",dense:"",type:"textarea",rows:"2",class:"q-mt-md",placeholder:"플레이리스트에 대한 설명을 입력하세요..."},null,8,["modelValue"])]),_:1}),t(te,{align:"right"},{default:o(()=>[t(S,{round:"",flat:"",icon:"cancel",color:"grey",onClick:n,disable:y.value},{default:o(()=>[t($,{msg:"취소"})]),_:1},8,["disable"]),t(S,{round:"",flat:"",icon:"check_circle",color:"primary",onClick:l,disable:!v.value||p.value||y.value,loading:y.value},{default:o(()=>[t($,{msg:"만들기"})]),_:1},8,["disable","loading"])]),_:1})]),_:1})]),_:1},512))}},me=M(ce,[["__scopeId","data-v-473a8dd8"]]),fe={class:"row no-wrap justify-between items-center"},_e={class:"row no-wrap items-center q-gutter-x-sm"},ye={class:"row no-wrap items-center q-gutter-x-sm"},ve={__name:"playlistHeader",setup(e){const a=oe(),c=()=>{a.dialog({component:me}).onOk(async s=>{try{console.log("새 플레이리스트 생성됨:",s),a.notify({type:"positive",message:`플레이리스트 "${s.name}"이 생성되었습니다.`,position:"top"})}catch(d){console.error("플레이리스트 생성 실패:",d),a.notify({type:"negative",message:"플레이리스트 생성에 실패했습니다.",position:"top"})}}).onCancel(()=>{console.log("플레이리스트 생성 취소됨")})};return(s,d)=>(z(),L("div",fe,[w("div",_e,[t(E,{name:"list_alt",size:"md",color:"primary"}),d[0]||(d[0]=w("div",{class:"text-title"},"Playlist",-1))]),w("div",ye,[t(S,{round:"",flat:"",color:"primary",icon:"add_box",onClick:c},{default:o(()=>[t($,{msg:"Add Playlist"})]),_:1}),t(le,{vertical:""}),t(S,{round:"",flat:"",color:"primary",icon:"format_list_bulleted_add"},{default:o(()=>[t($,{msg:"Add Track"})]),_:1})])]))}},pe={__name:"playlistView",setup(e){return(a,c)=>"playlist"}},ge={};function he(e,a){return"listView"}const we=M(ge,[["render",he]]),be={class:"q-pa-md"},xe={class:"q-pa-md"},Pe={class:"q-pa-md"},ze={__name:"PlaylistPage",setup(e){const a=_(50);return(c,s)=>(z(),L("div",be,[t(B,null,{default:o(()=>[t(q,null,{default:o(()=>[t(ve)]),_:1}),t(q,null,{default:o(()=>[t(ne,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=d=>a.value=d),style:{height:"70vh"}},{before:o(()=>[w("div",xe,[t(pe)])]),after:o(()=>[w("div",Pe,[t(we)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]))}};export{ze as default};
